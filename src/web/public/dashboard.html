<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wolni Farmerzy Bot - Dashboard</title>
  <link rel="stylesheet" href="/css/style.css">
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <nav class="navbar">
    <div class="nav-brand">ğŸŒ¾ Wolni Farmerzy Bot</div>
    <div class="nav-user">
      <span id="userName"></span>
      <button onclick="logout()" class="btn btn-small">Wyloguj</button>
    </div>
  </nav>
  
  <div class="container">
    <aside class="sidebar">
      <h3>Konta gry</h3>
      <div id="accountsList" class="accounts-list"></div>
      <button onclick="showAddAccountModal()" class="btn btn-secondary btn-full">+ Dodaj konto</button>
      
      <div class="sidebar-section">
        <h4>Status schedulera</h4>
        <div id="schedulerStatus" class="status-box">
          <span class="status-indicator"></span>
          <span class="status-text">Åadowanie...</span>
        </div>
      </div>
    </aside>
    
    <main class="main-content">
      <div id="welcomeScreen" class="welcome-screen">
        <h2>Witaj w panelu bota!</h2>
        <p>Wybierz konto z listy po lewej stronie lub dodaj nowe.</p>
      </div>
      
      <div id="accountDetails" class="account-details hidden">
        <div class="account-header">
          <h2 id="accountEmail">-</h2>
          <div class="account-actions">
            <button onclick="testLogin()" class="btn btn-secondary btn-small">Test logowania</button>
            <button onclick="refreshGameStatus()" class="btn btn-info btn-small">ğŸ”„ OdÅ›wieÅ¼ status</button>
          </div>
        </div>
        
        <!-- Przyciski akcji -->
        <div class="module-actions">
          <button onclick="runFarm()" class="btn btn-module btn-farm">ğŸŒ¾ Farma</button>
          <button onclick="runForestry()" class="btn btn-module btn-forestry">ğŸŒ² Tartak</button>
          <button onclick="runStalls()" class="btn btn-module btn-stalls">ğŸª Stragany</button>
          <button onclick="runCycle()" class="btn btn-module btn-cycle">ğŸ”„ PeÅ‚ny cykl</button>
        </div>
        
        <!-- Status wykonania -->
        <div id="moduleStatus" class="module-status hidden">
          <div class="status-icon">â³</div>
          <div class="status-text">Wykonywanie...</div>
        </div>
        
        <!-- LIVE STATUS GRY -->
        <div class="game-status-panel">
          <h3>ğŸ“Š Status gry <small id="statusFetchTime"></small></h3>
          
          <!-- Status straganÃ³w -->
          <div class="status-section">
            <h4>ğŸª Stragany</h4>
            <div id="stallsStatus" class="stalls-status-grid">
              <p class="no-data">Kliknij "OdÅ›wieÅ¼ status" aby pobraÄ‡ dane z gry</p>
            </div>
          </div>
          
          <!-- Status pÃ³l -->
          <div class="status-section">
            <h4>ğŸŒ¾ Pola (zbliÅ¼ajÄ…ce siÄ™ zbiory)</h4>
            <div id="fieldsStatus" class="fields-status-grid">
              <p class="no-data">Brak danych</p>
            </div>
          </div>
        </div>
        
        <!-- KONFIGURACJA STRAGANÃ“W -->
        <div class="config-panel">
          <h3>âš™ï¸ Konfiguracja straganÃ³w</h3>
          <p class="config-info">Wybierz produkt dla kaÅ¼dego slotu. W jednym straganie nie mogÄ… byÄ‡ dwa takie same produkty!</p>
          
          <div class="stalls-config">
            <!-- Stragan 1 -->
            <div class="stall-config-card">
              <h4>Stragan 1</h4>
              <div class="slot-config">
                <label>Slot 1:</label>
                <select id="stall1_slot1" onchange="validateStallProducts(1)">
                  <option value="">-- WyÅ‚Ä…czony --</option>
                </select>
              </div>
              <div class="slot-config">
                <label>Slot 2:</label>
                <select id="stall1_slot2" onchange="validateStallProducts(1)">
                  <option value="">-- WyÅ‚Ä…czony --</option>
                </select>
              </div>
            </div>
            
            <!-- Stragan 2 -->
            <div class="stall-config-card">
              <h4>Stragan 2</h4>
              <div class="slot-config">
                <label>Slot 1:</label>
                <select id="stall2_slot1" onchange="validateStallProducts(2)">
                  <option value="">-- WyÅ‚Ä…czony --</option>
                </select>
              </div>
            </div>
          </div>
          
          <button onclick="saveStallsConfig()" class="btn btn-primary">ğŸ’¾ Zapisz konfiguracjÄ™ straganÃ³w</button>
        </div>
        
        <!-- USTAWIENIA MODUÅÃ“W -->
        <div class="config-panel">
          <h3>ğŸ”§ Ustawienia moduÅ‚Ã³w</h3>
          <form id="settingsForm" class="settings-form-compact">
            <div class="modules-grid">
              <!-- Farma -->
              <div class="module-config-card">
                <h4>ğŸŒ¾ Farma</h4>
                <label class="checkbox-label">
                  <input type="checkbox" id="farmEnabled" name="farm_enabled">
                  <span>WÅ‚Ä…czona</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="farmAutoHarvest" name="farm_auto_harvest">
                  <span>Auto zbiÃ³r</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="farmAutoPlant" name="farm_auto_plant">
                  <span>Auto sadzenie</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="farmAutoWater" name="farm_auto_water">
                  <span>Auto podlewanie</span>
                </label>
              </div>
              
              <!-- Stragany -->
              <div class="module-config-card">
                <h4>ğŸª Stragany</h4>
                <label class="checkbox-label">
                  <input type="checkbox" id="stallsEnabled" name="stalls_enabled">
                  <span>WÅ‚Ä…czone</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="stallsAutoRestock" name="stalls_auto_restock">
                  <span>Auto uzupeÅ‚nianie</span>
                </label>
              </div>
              
              <!-- Tartak -->
              <div class="module-config-card">
                <h4>ğŸŒ² Tartak</h4>
                <label class="checkbox-label">
                  <input type="checkbox" id="forestryEnabled" name="forestry_enabled">
                  <span>WÅ‚Ä…czony</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="forestryAutoHarvest" name="forestry_auto_harvest">
                  <span>Auto zbiÃ³r</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="forestryAutoPlant" name="forestry_auto_plant">
                  <span>Auto sadzenie</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="forestryAutoProduction" name="forestry_auto_production">
                  <span>Auto produkcja</span>
                </label>
              </div>
            </div>
            
            <button type="submit" class="btn btn-primary">ğŸ’¾ Zapisz ustawienia</button>
          </form>
        </div>
        
        <!-- LOGI -->
        <div class="config-panel">
          <h3>ğŸ“œ Ostatnie akcje</h3>
          <div id="logsList" class="logs-list-compact">
            <p class="no-data">Brak logÃ³w</p>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- Modal dodawania konta -->
  <div id="addAccountModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Dodaj konto gry</h3>
        <button onclick="closeModal()" class="modal-close">&times;</button>
      </div>
      <form id="addAccountForm">
        <div class="form-group">
          <label for="gameEmail">Email / Login do gry</label>
          <input type="text" id="gameEmail" name="email" required>
        </div>
        <div class="form-group">
          <label for="gamePassword">HasÅ‚o do gry</label>
          <input type="password" id="gamePassword" name="password" required>
        </div>
        <div class="form-group">
          <label for="gameServer">Serwer</label>
          <select id="gameServer" name="server">
            <option value="1">Serwer 1</option>
            <option value="2">Serwer 2</option>
            <option value="3">Serwer 3</option>
          </select>
        </div>
        <div class="form-actions">
          <button type="button" onclick="closeModal()" class="btn btn-secondary">Anuluj</button>
          <button type="submit" class="btn btn-primary">Dodaj konto</button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Toast notifications -->
  <div id="toastContainer" class="toast-container"></div>
  
  <script src="/js/dashboard.js"></script>
</body>
</html>
